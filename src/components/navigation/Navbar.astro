---
import type { NavLinksProps } from '@/lib/navigation';
import { DEFAULT_NAV_LINKS } from '@/lib/navigation';

interface NavbarProps {
  title?: string;
  navLinks?: NavLinksProps[];
}

const { title = 'Lagunas Claras', navLinks = DEFAULT_NAV_LINKS } = Astro.props as NavbarProps;
---

<nav
  id="navbar"
  class="fixed top-0 z-50 w-full
    transition-all duration-300
    bg-transparent
    nav"
>
  <div class="max-w-7xl mx-auto flex items-center justify-between h-16 px-4">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-2 font-bold text-lg text-primary">
      <img src="/logo.png" alt="Lagunas Claras" class="h-6 w-6 min-w-6" />
      <span class="nav-text font-semibold">{title}</span>
    </a>

    <!-- Navigation Links -->
    <ul class="flex gap-6 text-base font-medium">
      {
        navLinks.map((link) => (
          <li>
            <a href={link.href} class="nav-link transition-colors relative">
              {link.title}
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</nav>

<script>
  const nav = document.getElementById('navbar');
  if (!nav) return;

  const sentinel = document.querySelector('#hero-sentinel');
  const observer = new IntersectionObserver(
    ([entry]) => {
      nav.classList.toggle('nav-on-hero', entry.isIntersecting);
      nav.classList.toggle('nav-default', !entry.isIntersecting);
    },
    { threshold: 0 }
  );

  if (sentinel) observer.observe(sentinel);
  console.log(sentinel);

  nav.classList.add('nav-on-hero');
</script>

<style>
  /* ===== Navbar base ===== */
  .nav .nav-text,
  .nav .nav-link {
    color: hsl(var(--primary-foreground));
  }

  /* ===== Navbar over Hero ===== */
  .nav-on-hero {
    background-color: hsl(var(--primary) / 0.25);
    backdrop-filter: blur(10px);
  }

  .nav-on-hero .nav-link::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -4px;
    width: 0;
    height: 2px;
    background-color: hsl(var(--accent));
    transition: width 0.25s ease;
  }

  .nav-on-hero .nav-link:hover::after {
    width: 100%;
  }

  /* ===== Navbar default (non-hero) ===== */
  .nav-default {
    background-color: hsl(var(--background) / 0.85);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid hsl(var(--border));
  }

  .nav-default .nav-text,
  .nav-default .nav-link {
    color: hsl(var(--foreground));
  }

  .nav-default .nav-link:hover {
    color: hsl(var(--primary));
  }
</style>
