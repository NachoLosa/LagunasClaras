---
import clsx from 'clsx';

interface ButtonProps {
  href?: string;
  type?: 'button' | 'submit' | 'reset';
  variant?: 'primary' | 'secondary' | 'underline';
  size?: 'sm' | 'md' | 'lg';
  icon?: boolean;
  disabled?: boolean;
  class?: string;
  as?: 'a' | 'button';
}

const {
  href,
  type = 'button',
  variant = 'primary',
  size = 'md',
  icon = false,
  disabled = false,
  class: className = '',
  as,
} = Astro.props as ButtonProps;

// Auto-detect element type if not specified
const element = as || (href ? 'a' : 'button');

// Base styles shared by all buttons
const baseStyles =
  'group relative inline-flex items-center justify-center overflow-hidden font-semibold transition-all duration-300 active:scale-95 disabled:pointer-events-none disabled:opacity-50';

// Variant styles
const variantStyles = {
  primary:
    'bg-primary text-white shadow-lg shadow-blue-200 hover:-translate-y-1 hover:bg-blue-700 hover:shadow-blue-300',
  secondary:
    'bg-card text-primary border-2 border-primary hover:bg-primary hover:text-white hover:-translate-y-1 shadow-md hover:shadow-lg',
  underline:
    'bg-transparent text-primary-foreground/80 hover:text-primary-foreground underline-offset-4 hover:-translate-y-0.5 hover:underline shadow-none',
};

// Size styles
const sizeStyles = {
  sm: 'rounded-lg px-4 py-2 text-sm',
  md: 'rounded-xl px-8 py-3 text-lg',
  lg: 'rounded-xl px-10 py-5 text-xl',
};

const buttonClasses = clsx(
  baseStyles,
  variantStyles[variant as keyof typeof variantStyles],
  sizeStyles[size as keyof typeof sizeStyles],
  icon && 'pr-4',
  className
);

const arrowClasses =
  'ml-2 h-5 w-5 -translate-x-2 transform opacity-0 transition-all duration-300 group-hover:translate-x-0 group-hover:opacity-100';
---

{
  element === 'a' ? (
    <a href={href} role="button" class={buttonClasses}>
      <slot />
      {icon && variant !== 'underline' && (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class={arrowClasses}
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"
          />
        </svg>
      )}
    </a>
  ) : (
    <button type={type} disabled={disabled} class={buttonClasses}>
      <slot />
      {icon && variant !== 'underline' && (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class={arrowClasses}
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"
          />
        </svg>
      )}
    </button>
  )
}
